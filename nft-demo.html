<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFT Pairing System Demo - Myl.Zip</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .setup-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
        }

        .setup-section h2 {
            color: #495057;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .input-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .input-group input {
            padding: 12px 20px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus {
            border-color: #28a745;
        }

        .btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            font-weight: 600;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(40, 167, 69, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .nft-container {
            text-align: center;
            padding: 20px;
            background: white;
            border-radius: 15px;
            border: 2px dashed #e9ecef;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .nft-container h3 {
            color: #6c757d;
            margin-bottom: 15px;
            font-weight: 400;
        }

        .nft-container p {
            color: #adb5bd;
            font-size: 0.9rem;
        }

        .nft-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin-top: 20px;
            max-width: 800px;
        }

        .nft-item {
            text-align: center;
            transition: transform 0.2s ease;
        }

        .nft-item:hover {
            transform: scale(1.05);
        }

        .nft-item canvas {
            border: 3px solid #e9ecef;
            border-radius: 15px;
            cursor: pointer;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .nft-item canvas:hover {
            border-color: #28a745;
            box-shadow: 0 10px 20px rgba(40, 167, 69, 0.2);
        }

        .nft-label {
            margin-top: 10px;
            font-size: 0.9rem;
            font-weight: 600;
            color: #495057;
        }

        .pairing-token {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }

        .pairing-token h4 {
            color: #155724;
            margin-bottom: 15px;
        }

        .token-display {
            background: #f8f9fa;
            border: 2px solid #c3e6cb;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 1.2rem;
            font-weight: bold;
            color: #155724;
            margin: 15px 0;
            letter-spacing: 2px;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .feature-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 1px solid #e9ecef;
        }

        .feature-card h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .feature-card p {
            color: #6c757d;
            line-height: 1.6;
        }

        .feature-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            display: block;
        }

        .status {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .status.show {
            transform: translateX(0);
        }

        .status.success {
            background: #28a745;
        }

        .status.error {
            background: #dc3545;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #28a745;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .input-group {
                flex-direction: column;
            }
            
            .nft-grid {
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ NFT Pairing System</h1>
            <p>Generate unique geometric NFTs for device pairing and profile pictures</p>
        </div>

        <div class="content">
            <div class="setup-section">
                <h2>üöÄ Get Started</h2>
                <div class="input-group">
                    <input type="text" id="userInitials" placeholder="Enter your initials (2-3 chars)" maxlength="3" value="JD">
                    <input type="text" id="deviceId" placeholder="Device ID (optional)" value="demo-device-001">
                    <button class="btn" id="generateBtn" onclick="generateNFTs()">
                        <span class="loading" id="loadingSpinner" style="display: none;"></span>
                        Generate NFTs
                    </button>
                </div>
                <p style="color: #6c757d; font-size: 0.9rem;">
                    Enter your initials and optionally a device ID, then click "Generate NFTs" to create your unique collection.
                </p>
            </div>

            <div class="nft-container" id="nft-container">
                <h3>üé® Your NFT Collection</h3>
                <p>Click "Generate NFTs" above to create your unique geometric NFT collection.</p>
                <p style="font-size: 0.8rem; margin-top: 10px; color: #adb5bd;">
                    One NFT will be marked as a pairing token, others can be used as profile pictures.
                </p>
            </div>

            <div class="features">
                <div class="feature-card">
                    <span class="feature-icon">üîê</span>
                    <h3>Secure Pairing</h3>
                    <p>Generate unique pairing tokens with 24-hour expiration for secure device authentication.</p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">üé®</span>
                    <h3>Unique Designs</h3>
                    <p>Each NFT features unique geometric patterns with customizable colors and shapes.</p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">üì±</span>
                    <h3>Cross-Platform</h3>
                    <p>Works seamlessly across Chrome extensions, Obsidian plugins, VS Code, and web applications.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="status" id="status"></div>

    <script src="frontend-nft-implementation.js"></script>
    <script>
        let nftSystem = null;
        let currentPairingToken = null;

        // Initialize the NFT system
        async function generateNFTs() {
            const userInitials = document.getElementById('userInitials').value.trim();
            const deviceId = document.getElementById('deviceId').value.trim();
            const generateBtn = document.getElementById('generateBtn');
            const loadingSpinner = document.getElementById('loadingSpinner');

            if (!userInitials) {
                showStatus('Please enter your initials', 'error');
                return;
            }

            if (userInitials.length < 2 || userInitials.length > 3) {
                showStatus('Initials must be 2-3 characters', 'error');
                return;
            }

            // Show loading state
            generateBtn.disabled = true;
            loadingSpinner.style.display = 'inline-block';
            generateBtn.textContent = 'Generating...';

            try {
                // Create new NFT system instance
                nftSystem = new NFTPairingSystem();
                
                // Initialize the system
                const result = await nftSystem.initialize('nft-container', userInitials, deviceId || undefined);
                
                if (result.success) {
                    showStatus(`Generated ${result.nftCount} unique NFTs!`, 'success');
                    
                    // Add export buttons
                    addExportButtons();
                    
                    // Add pairing info display
                    addPairingInfoDisplay();
                } else {
                    showStatus(`Failed to generate NFTs: ${result.error}`, 'error');
                }
            } catch (error) {
                console.error('Error generating NFTs:', error);
                showStatus(`Error: ${error.message}`, 'error');
            } finally {
                // Reset button state
                generateBtn.disabled = false;
                loadingSpinner.style.display = 'none';
                generateBtn.innerHTML = '<span class="loading" id="loadingSpinner" style="display: none;"></span>Generate NFTs';
            }
        }

        // Add export buttons to the NFT container
        function addExportButtons() {
            const container = document.getElementById('nft-container');
            
            // Add export section
            const exportSection = document.createElement('div');
            exportSection.style.cssText = 'margin-top: 20px; padding: 20px; background: #f8f9fa; border-radius: 10px;';
            exportSection.innerHTML = `
                <h4 style="margin-bottom: 15px; color: #495057;">üì§ Export Options</h4>
                <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                    <button class="btn" onclick="exportAllAsSVG()" style="background: #17a2b8; font-size: 0.9rem; padding: 8px 16px;">
                        Export All as SVG
                    </button>
                    <button class="btn" onclick="exportAllAsPNG()" style="background: #6f42c1; font-size: 0.9rem; padding: 8px 16px;">
                        Export All as PNG
                    </button>
                </div>
            `;
            
            container.appendChild(exportSection);
        }

        // Add pairing info display
        function addPairingInfoDisplay() {
            const container = document.getElementById('nft-container');
            
            // Add pairing info section
            const pairingSection = document.createElement('div');
            pairingSection.id = 'pairing-info';
            pairingSection.style.cssText = 'margin-top: 20px; padding: 20px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 10px; display: none;';
            pairingSection.innerHTML = `
                <h4 style="margin-bottom: 15px; color: #856404;">üîó Pairing Information</h4>
                <p style="color: #856404; margin-bottom: 15px;">Click on the NFT marked as "Pairing Token" to generate a pairing code.</p>
                <div id="pairing-token-display"></div>
            `;
            
            container.appendChild(pairingSection);
        }

        // Export all NFTs as SVG
        function exportAllAsSVG() {
            if (!nftSystem) return;
            
            const collection = nftSystem.getNFTCollection();
            collection.forEach((nft, index) => {
                setTimeout(() => {
                    nftSystem.exportNFTAsSVG(nft);
                }, index * 100);
            });
            
            showStatus(`Exported ${collection.length} NFTs as SVG files`, 'success');
        }

        // Export all NFTs as PNG
        function exportAllAsPNG() {
            if (!nftSystem) return;
            
            const collection = nftSystem.getNFTCollection();
            collection.forEach((nft, index) => {
                setTimeout(() => {
                    nftSystem.exportNFTAsPNG(nft);
                }, index * 100);
            });
            
            showStatus(`Exported ${collection.length} NFTs as PNG files`, 'success');
        }

        // Show status message
        function showStatus(message, type = 'success') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type} show`;
            
            setTimeout(() => {
                status.classList.remove('show');
            }, 3000);
        }

        // Override the NFT system's pairing token handler to show in our UI
        if (typeof NFTPairingSystem !== 'undefined') {
            const originalHandlePairingTokenClick = NFTPairingSystem.prototype.handlePairingTokenClick;
            
            NFTPairingSystem.prototype.handlePairingTokenClick = function(nft) {
                // Call original method
                originalHandlePairingTokenClick.call(this, nft);
                
                // Show pairing info in our UI
                const pairingSection = document.getElementById('pairing-info');
                const pairingTokenDisplay = document.getElementById('pairing-token-display');
                
                if (pairingSection && pairingTokenDisplay) {
                    const pairingToken = this.getPairingToken();
                    if (pairingToken) {
                        pairingSection.style.display = 'block';
                        pairingTokenDisplay.innerHTML = `
                            <div class="pairing-token">
                                <h4>üéØ Pairing Token Generated!</h4>
                                <div class="token-display">${pairingToken.token}</div>
                                <p><strong>Device ID:</strong> ${pairingToken.deviceId}</p>
                                <p><strong>Expires:</strong> ${pairingToken.expiresAt.toLocaleString()}</p>
                                <p><em>Share this token with the device you want to pair with.</em></p>
                            </div>
                        `;
                        
                        showStatus('Pairing token generated successfully!', 'success');
                    }
                }
            };
        }

        // Add some interactivity to the demo
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-fill demo values
            document.getElementById('userInitials').addEventListener('input', function() {
                this.value = this.value.toUpperCase();
            });
            
            // Show helpful tooltips
            const inputs = document.querySelectorAll('input');
            inputs.forEach(input => {
                input.addEventListener('focus', function() {
                    this.style.borderColor = '#28a745';
                });
                
                input.addEventListener('blur', function() {
                    this.style.borderColor = '#e9ecef';
                });
            });
        });
    </script>
</body>
</html>
